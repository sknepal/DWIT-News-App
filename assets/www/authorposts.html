<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="format-detection" content="telephone=no" />
		<meta name="viewport" id="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height;" />

		<link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.min.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<link rel="stylesheet" type="text/css" href="css/jquery.mobile.pagination.css" />
		<link rel="stylesheet" href="css/jquery.mobile.iscrollview.css" />
		<link rel="stylesheet" href="css/jquery.mobile.iscrollview-pull.css" />
		<script type="text/javascript" src="cordova.js"></script>
		<script type="text/javascript" src="js/libs/handlebars.js"></script>
		<script type="text/javascript" src="js/index.js"></script>
		<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
		<script type="text/javascript" src="js/jquery.mobile-1.4.5.min.js"></script>
		<script type="text/javascript" src="js/SocialSharing.js"></script>
		<script src="js/iscroll.js" type="text/javascript"></script>
		<script src="js/jquery.mobile.iscrollview.js" type="text/javascript"></script>
		<script src="pull.js" type="text/javascript"></script>
		<script src="js/custom.js" type="text/javascript"></script>
        <script src="js/jquery.touchSwipe.min.js" type="text/javascript"></script>
		<!-- Font-Awesome Icons -->
		<link href="font_awesome/css/font-awesome.min.css" rel="stylesheet">
		<title>Author Posts</title>
	</head>
	<body>
		<div class="hwrapper" data-role="page" id="authorposts-page" data-dom-cache="true">
			<div class="panel left" data-role="panel" data-position="left" data-display="push" id="panel-left">
				<ul>
					<li class="home">
						<a href="" onclick="changePage('index.html');"  title="Home" data-rel="close" in-app="true">Home</a>
					</li>
					<li class="authors">
						<a href="" onclick="changePage('authors.html');" title="Authors" data-rel="close" in-app="true" >Authors</a>
					</li>
					<li class="aboutus">
						<a href="" onclick="changePage('page.html?page=about-us');" title="About Us" data-rel="close" in-app="true" >About Us</a>
					</li>
					
					<li class="search">
						<a href="javascript:$.mobile.activePage.find('#popupSearch').popup('open');" data-rel="popup" data-position-to="window" data-transition="pop" title="Search" in-app="true">Search</a>
					</li>

					<div data-role="popup" id="popupSearch" class="ui-content" data-theme="a" >
						<form action="" onsubmit="changePage('searchresults.html?search=' + $.mobile.activePage.find('#search').val());" target="_blank">
							<input type="search" name="search" id="search" value="" data-mini="true" placeholder="Search for..." autofocus/>

						</form>
					</div>
				</ul>
			</div>
			<div class="header" data-role="header" >
				<span class="open left"><a href="javascript:$.mobile.activePage.find('#panel-left').panel('open'); " in-app="true">&#xe809;</a></span>
				<span class="title">DWIT News</span>
				<span class="open right"><a href="javascript:$.mobile.activePage.find('#panel-right').panel('open'); " in-app="true">&#xe805;</a></span>
			</div>

			<div class="panel right" data-role="panel" data-position="right" data-display="overlay" id="panel-right">

				<ul>
					<li class="news">
						<a href="" onclick="changePage('category.html?cat=news-3');" title="News" data-rel="close" in-app="true">News</a>
					</li>
					<li class="reviews">
						<a href="" onclick="changePage('category.html?cat=reviews');" title="Reviews" data-rel="close" in-app="true">Reviews</a>
					</li>
					<li class="people">
						<a href="" onclick="changePage('category.html?cat=people');" title="People" data-rel="close" in-app="true">People</a>
					</li>
					<li class="creativity">
						<a href="" onclick="changePage('category.html?cat=creativity');" title="Creativity" data-rel="close" in-app="true">Creativity</a>
					</li>
					<li class="opinion">
						<a href="" onclick="changePage('category.html?cat=opinion');" title="Opinion" data-rel="close" in-app="true">Opinion</a>
                        <li class="faculty">
						<a href="" onclick="changePage('category.html?cat=faculty-corner');" title="Faculty" data-rel="close" in-app="true">Faculty</a>
					</li>
				</ul>
			</div>
			<div id="authorposts-content" data-role="content" class="authorpostsblog">

				<div id="authorp-data" data-iscroll="" class="awrapper">
                    	<div class="iscroll-pulldown">
						<span class="iscroll-pull-icon"></span><span class="iscroll-pull-label"></span>
					</div>
                      <div class="scrollwrap"></div>
					<script id="authorposts-template" type="text/x-handlebars-template">
						{{#each posts}}
						<li><a href="javascript:changePage('single.html?{{@index}}');" in-app="true" data-direction="reverse">
						<h3 style="font-size: 22px;">{{{this.title}}}</h3>
						<span style="font-size: 16px;background: rgb(40, 114, 64);color: #fff;text-shadow: none;
						margin-right: 15px;padding: 0px 5px;margin-top: -10px;	" class="ui-li-count">{{comments.length}}</span>
						<p style="white-space:normal"> <strong> Author:</strong> {{{author.name}}}</p>
						<p style="white-space:normal"><strong style="color: rgb(16, 83, 137);font-size: 14px;text-shadow: none;"> {{{categories.0.title}}}</strong> -  <em>{{prettifyDate date}} </em>  </p>
						<p class="ui-li-aside"></p>
						</a></li>
						{{/each}}
					</script>
                           <div class="iscroll-pullup">
        <span class="iscroll-pull-icon"></span>
        <span class="iscroll-pull-label"></span>
      </div>
				</div>

			</div>
			<div class="footer" data-id="footer" data-role="footer" data-tap-toggle="false" data-transition="slidedown">
				<div data-role="navbar">
					<ul>
						<li>
							<a id="feedForward" href="javascript:prev('author', urlParamsAuth['authname'])" in-app="true"><i class="fa fa-2x fa-arrow-circle-left"></i>&nbsp;&nbsp;<span style="position: relative;top: -4px;">Prev</span></a>
						</li>
						<li>
							<a id="feedForward" href="javascript:next('author', urlParamsAuth['authname'])" in-app="true"><i class="fa fa-2x fa-arrow-circle-right"></i>&nbsp;&nbsp;<span style="position: relative;top: -4px;">Next</span></a>
						</li>
					</ul>
				</div>
			</div>
			<script type="text/javascript">
				page = 1;
			
				$(document).one("pageshow", '#authorposts-page', function(event, ui) {
       authorpostspage=1;
                    array = 'authorpostsArray';
                            beginAtAuthor = 0;
        $.mobile.activePage.find('#panel-left').on("click", function () {
                        $.mobile.activePage.find('#panel-left').panel("close");    
  // $("#panel-left").panel("close");
  }); 
					// Handler for .ready() called.
					loading();
					var urlParams;
					(window.onpopstate = function() {

						var match,
						    pl = /\+/g, // Regex for replacing addition symbol with a space
						    search = /([^&=]+)=?([^&]*)/g,
						    decode = function(s) {
							return decodeURIComponent(s.replace(pl, " "));
						},
						    query = window.location.search.substring(1);

						urlParamsAuth = {};
						while ( match = search.exec(query))
						urlParamsAuth[decode(match[1])] = decode(match[2]);
					})();
					app.get("author", 1, urlParamsAuth["authname"]);
				});

				$('form').on('submit', function(e) {
					e.preventDefault();
				});
				$('a').click(function(e) {
					var href = ["#panel-left", "#panel-right", "#"];
					if (!($.inArray($(e.currentTarget).attr('href'), href) != -1 || $(e.currentTarget).attr('in-app') == 'true')) {
						e.preventDefault();
						window.open($(e.currentTarget).attr('href'), '_system', '');
					}
				});
              $(document).one("pageinit", '#authorposts-page', function(event, ui) {  
              //  $('#authorposts-page').one("pageinit",function(event, ui){
					$(".iscroll-wrapper", this).bind({
						iscroll_onpulldown : function(event, data) {
                            authorpostspage=1;
                            beginAtAuthor = 0;
							app.get("author", 1, urlParamsAuth["authname"]);
							data.iscrollview.refresh();
						}
                    });
                    	$(".iscroll-wrapper", this).bind({
                        iscroll_onpullup : function(event, data){
                               if ($.mobile.activePage.find('#authorposts-page-posts li').length == 0) { 	app.get("author", authorpostspage, urlParamsAuth["authname"]); } else{
                        	app.get("author", ++authorpostspage, urlParamsAuth["authname"]);
                               }
                      //       console.log(page);
                        data.iscrollview.refresh();
                        
                    }
					});                        
				});
                
                	$("#panel-left").on("click", function() {
					$("#panel-left").panel("close");
				});
                
		$(document).on("pagebeforehide","#authorposts-page",function(){ // When leaving pagetwo
            request.abort();
 //  $("body").find("*").removeAttr("disabled");
   /* $("body").find("a").unbind("click");*/
});
                                   $(function() {      
      $("#authorposts-content").swipe( {
        //Generic swipe handler for all directions
        swipe:function(event, direction, distance, duration, fingerCount, fingerData) {
         // $(this).text("You swiped " + direction ); 
            console.log(direction);
            if (direction=='right')
                $.mobile.activePage.find('#panel-left').panel("open"); 
            else if (direction=='left')
                $.mobile.activePage.find('#panel-right').panel("open"); 
        }
      });
    });
                  $(document).on("pagehide","#authorposts-page",function(){ 
                    if (($.mobile.activePage[0].id)!='single-post-page') $(this).remove();
                    });
                
                   $(document).ajaxStart(function() {
    loading();
});

$(document).ajaxStop(function() {
    doneLoading();
});
			</script>

		</div>

	</body>
</html>
